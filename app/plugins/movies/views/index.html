
<link href="${_static}/style/search.css" media="screen" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="${_static}/script/movie.js"></script>
<script type="text/javascript">

	window.addEvent('domready', function(){
		
		var movies = new MovieList()

		var container = $('header').getElement('.navigation')
		var ms = new MovieSearch(container, {
			'url': '${_url(controller='movie', action='search')}'
		});

		var filterDetails = $('filterDetails').getElement('a')
		var toggleThem = function(){
			$('movies').toggleClass('list')
			filterDetails.set('text', !$('movies').hasClass('list') ? 'Hide details' : 'Show details')
			Cookie.write('showDetails', !$('movies').hasClass('list'), {duration: 365});
		}
		filterDetails.addEvent('click', function(e){
			(e).stop()
			toggleThem()
		})
		if(Cookie.read('showDetails') == 'true')
			toggleThem()
			
	})
	
</script>

<%
	totalWanted = len(movies.get('wanted'))
	totalSnatched = len(movies.get('snatched'))
	totalDownloaded = len(movies.get('downloaded'))
%>

<div id="filterDetails">
	<span class="counter"><strong>${totalWanted}</strong> wanted</span>
	% if totalSnatched > 0:
	<span class="counter"><strong>${totalSnatched}</strong> snatched</span>
	% endif
	% if totalDownloaded > 0:
	<span class="counter"><strong>${totalDownloaded}</strong> downloaded</span>
	% endif
	<a href="#">Show details</a>
</div>

<div id="movies">

% if totalWanted == 0:
	<a href="#" id="firstAdd">No movies added, click here to add a movie.</a>
	<script type="text/javascript">
		window.addEvent('domready', function(){
			$('firstAdd').addEvent('click', function(e){
				(e).stop();
				var firstEl = $('addForm').getElement('input');
				if (firstEl){
					firstEl.focus()
					firstEl.highlight()
				}
			});
		});
	</script>
% endif

% for key in movies:
	<%include file="/list.html" args="movies = movies.get(key), title = key.title()"/>
% endfor

</div>

<%inherit file="/base.html" />